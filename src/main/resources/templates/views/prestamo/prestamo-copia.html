<!DOCTYPE html>
<html xmlns:th="https://wwww.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
    <title>Préstamo</title>
    <link rel="stylesheet" type="text/css" th:href="@{/assets/css/estiloC.css}">
    <link rel="stylesheet" href="../assets/css/estilos2.css">
    <link rel="stylesheet" href="../assets/css/stylev.css">
    <link rel="icon" href="../assets/img/Icon-cuentascasa.png"> 
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct" crossorigin="anonymous"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/mobius1/vanilla-Datatables@latest/vanilla-dataTables.min.css">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/mobius1/vanilla-Datatables@latest/vanilla-dataTables.min.js"></script>
</head>
<body>
    <div th:replace="/views/header :: nav"></div>
    <div class="title">
      <h1>Préstamo</h1>
      <a href="" data-toggle="modal" data-target="#modal-add"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" class="bi bi-plus-circle-fill" viewBox="0 0 16 16">
        <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8.5 4.5a.5.5 0 0 0-1 0v3h-3a.5.5 0 0 0 0 1h3v3a.5.5 0 0 0 1 0v-3h3a.5.5 0 0 0 0-1h-3v-3z"/>
      </svg></a>
    </div>
    
    <div class="alerta">
        <div class="alert alert-warning alert-dismissible fade show" role="alert" th:if="${prestamos.size()==0}">
        <strong>Precaución!</strong> No hay préstamos para mostrar
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
        </div>
    </div>
    <div class="alerta">
      <div class="alert alert-warning alert-dismissible fade show" role="alert" th:if="${prestamos.size()>=7}">
      <strong>Precaución!</strong> Puedes ver todos los prestamos, puedes buscarlos o ordenarlos
      <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
      </div>
  </div>
    
    <input type="checkbox" id="mostrar">Mostrar préstamos inactivos

    <table border="1" id="table-prestamo">
        <thead>
            <th>Id</th>
            <th>Documento Prestamista</th>
            <th>Nombre Prestamista</th>
            <th>Fecha de Pago Oportuno</th>
            <th>Valor del Préstamo</th>
            <th>Tasa de Préstamo</th>
            <th>Periodo de Cuotas</th>
            <th>Número de Cuotas</th>
            <th>Pagos y Abonos</th>
            <th>Estado</th>
            <th>Acciones</th>
            
        </thead>
        <tr th:each="Pr:${prestamos}" id="tablerow">
            <td th:text="${Pr.idPrestamo}"></td>
            <td th:text="${Pr.documentoPrestamista}"></td>
            <td th:text="${Pr.nombrePrestamista}"></td>
            <td th:text="${Pr.fechaPagoOportuno}"></td>
            <td th:text="${Pr.valorPrestamo}"></td>
            <td th:text="${Pr.tasaPrestamo}+'%'"></td>
            <td th:text="${Pr.periodoCuota}"></td>
            <td th:text="${Pr.numeroCuotas}"></td> 
            <td th:if="${Pr.valorPrestamo>0}">
                <button>
                  <a href="" data-toggle="modal" data-target="#modal-addp">Pagos</a>
                </button>
            </td>
            <td th:if="${Pr.valorPrestamo==0}">
              Este prestamo ya esta pagó
            </td>
            <td th:text="${Pr.estadoPrestamo}" id="estado"></td>
            <td>
                <a href="" data-toggle="modal" th:attr="data-target='#modal-editar'+${Pr.idPrestamo}"><button type="button" class="btn btn-dark"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pen-fill" viewBox="0 0 16 16">
                <path d="m13.498.795.149-.149a1.207 1.207 0 1 1 1.707 1.708l-.149.148a1.5 1.5 0 0 1-.059 2.059L4.854 14.854a.5.5 0 0 1-.233.131l-4 1a.5.5 0 0 1-.606-.606l1-4a.5.5 0 0 1 .131-.232l9.642-9.642a.5.5 0 0 0-.642.056L6.854 4.854a.5.5 0 1 1-.708-.708L9.44.854A1.5 1.5 0 0 1 11.5.796a1.5 1.5 0 0 1 1.998-.001z"/>
                </svg></button></a>
                
                <!-- MODAL EDITAR -->
                <div class="modal fade" tabindex="-1" th:id="modal-editar+${Pr.idPrestamo}">
                    <div class="modal-dialog">
                      <div class="modal-content">
                        <div class="modal-header">
                          <h5 class="modal-title">Editar Préstamo</h5>
                        </div>
                        <form th:action="@{/prestamo/add}" method="post" th:object="${prestamo}">
                          <div class="modal-body">
                                  <input type="hidden" name="idPrestamo" id="idPrestamo" th:value="${Pr.idPrestamo}">

                                  <div>
                                  <label for="">Documento Prestamista</label>
                                  <input type="number" name="documentoPrestamista" id="documentoPrestamista" step="1" min="10000000" max="9999999999" placeholder="Ej: 1079032167" autocomplete="off" th:value="${Pr.documentoPrestamista}" required>
                                  <span class="validity"></span>
                                  </div>
                                  <div>
                                  <label for="">Nombre Prestamista</label>
                                  <input type="text" name="nombrePrestamista" id="nombrePrestamista" minlength="5" maxlength="50" placeholder="Ejemplo: Cristhian López" autocomplete="off" th:value="${Pr.nombrePrestamista}" required>
                                  <span class="validity"></span>
                                  </div>
                                  <div>
                                  <label for="">Fecha pago oportuno</label>
                                  <input type="date" name="fechaPagoOportuno" id="fechaPagoOportuno" th:value="${Pr.fechaPagoOportuno}" min="2021-01-01" max="2022-12-31" required>
                                  <span class="validity"></span>
                                  </div>
                                  <div>
                                  <label for="valorPrestamo">Valor Prestamo</label>
                                  <input  type="number" name="valorPrestamo" id="valorPrestamo" th:value="${Pr.valorPrestamo}" step="1" min="1000000" placeholder="Ejemplo: 1500000" required>
                                  <span class="validity"></span>
                                  </div>
                                  <div>
                                  <label for="tasaPrestamo">Tasa Prestamo</label>
                                  <input  type="text" name="tasaPrestamo" id="tasaPrestamo" th:value="${Pr.tasaPrestamo}" minlength="2" maxlength="4" placeholder="Ejemplo: 5%" required>
                                  <span class="validity"></span>
                                  </div>
                                  <div>
                                  <label for="">Periodo Cuotas</label>
                                  <select name="periodoCuota" id="periodoCuota" required>
                                      <option th:value="${Pr.periodoCuota}" th:text="${Pr.periodoCuota}" selected>Seleccionar</option>
                                      <option value="Mensual">Mensual</option>
                                      <option value="Trimestral">Trimestral</option>
                                      <option value="Cuatrimensual">Cuatrimensual</option>
                                      <option value="Quinquemestral">Quinquemestral</option>
                                      <option value="Semestral">Semestral</option>
                                  </select>
                                  <span class="validity"></span>
                                  </div>
                                  <div>
                                  <label for="numeroCuotas">Número Cuotas</label>
                                  <input  type="number" name="numeroCuotas" id="numeroCuotas" th:value="${Pr.numeroCuotas}" min="1" max="96" required placeholder="Ejemplo: 12">
                                  <span class="validity"></span>
                                  </div>
                                  <div>
                                  <label for="">Estado Préstamo</label>
                                  <select name="estadoPrestamo" id="estadoPrestamo" required>
                                      <option th:value="${Pr.estadoPrestamo}" th:text="${Pr.estadoPrestamo}" selected>Seleccionar</option>
                                      <option value="Activo">Activo</option>
                                      <option value="Inactivo">Inactivo</option>
                                      <option value="Congelado">Congelado</option>
                                  </select>
                                  <span class="validity"></span>
                                  </div>
                          </div>
                          <div class="modal-footer">
                              <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
                              <button type="submit" class="btn bg-cuentas" id="submitEdit">Editar</button>
                          </div>
                        </form>
                      </div>
                    </div>
                </div>

                <a href="" data-toggle="modal" th:attr="data-target='#modal-delete'+${Pr.idPrestamo}"><button type="button" class="btn btn-dark"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash-fill" viewBox="0 0 16 16">
                <path d="M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1H2.5zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5zM8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5zm3 .5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 1 0z"/>
                </svg></button></a>

                <!-- MODAL ELIMINAR -->
                <div class="modal fade" tabindex="-1" th:id="modal-delete+${Pr.idPrestamo}">
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h5 class="modal-title">Eliminar Prestamo</h5>
                      </div>
                      <div class="modal-body">
                        <p>Esta seguro que desea ELIMINAR el Prestamo?</p>
                    </div>
                      
                      <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
                        <a role="button" class="btn bg-cuentas" th:href="@{/prestamo/delete/}+${Pr.idPrestamo}"> Eliminar Prestamo</a>
                          </div>
                    </div>
                  </div>
              </div>
            </td>
        </tr>
    </table>
    
    <!-- MODAL REGISTRAR -->
    <div class="modal fade" tabindex="-1" id="modal-add">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title">Registrar Préstamo</h5>
            </div> 
            <div class="modal-body">
                <form th:action="@{/prestamo/add}" method="post" th:object="${prestamo}" id="formulario" class="formulario">
                  <script th:inline="javascript" th:if="${#fields.hasErrors('*')}">$("#modal-add").modal("show");</script>
                  <script th:inline="javascript" th:if="${errorMessage}">$("#modal-add").modal("show");</script>

  <!-- Grupo: documento -->
  <div class="formulario__grupo" id="grupo__documentoPrestamista">
    <label for="documentoPrestamista" class="formulario__label">Documento Prestamista</label>
    <div class="formulario__grupo-input">
      <input type="number" class="formulario__input" step="1" min="10000000" max="9999999999"  name="documentoPrestamista" id="documentoPrestamista" placeholder="Ej: 1079032167" autocomplete="off">
      <i class="formulario__validacion-estado fas fa-times-circle"></i>
    </div>
    <p class="formulario__input-error"> tiene que ser de 8 a 10 dígitos y solo puede contener numeros</p>
  </div>
  <div class="error">
    <div class="form-text text-danger" th:if="${#fields.hasErrors('documentoPrestamista')}" th:errors="*{documentoPrestamista}"></div>
  </div>
  
  <!-- Grupo: Nombre Prestamista -->
  <div class="formulario__grupo" id="grupo__nombrePrestamista">
    <label for="nombrePrestamista" class="formulario__label">Nombre Prestamista</label>
    <div class="formulario__grupo-input">
      <input type="text" class="formulario__input" minlength="5" maxlength="50"  name="nombrePrestamista" id="nombrePrestamista"placeholder="Ejemplo: Cristhian López" autocomplete="off">
      <i class="formulario__validacion-estado fas fa-times-circle"></i>
    </div>
    <p class="formulario__input-error"> tiene que ser de 5 a 50 dígitos y solo puede contener letras, espacios y acentos.</p>
  </div>
  <div class="error">
    <div class="form-text text-danger" th:if="${#fields.hasErrors('nombrePrestamista')}" th:errors="*{nombrePrestamista}"></div>
  </div>

  <!-- Grupo: Fecha pago oportuno -->
  <div class="formulario__grupo" id="grupo__fechaPagoOportuno">
    <label for="nombre" class="formulario__label">Fecha pago oportuno</label>
    <div class="formulario__grupo-input">
      <input type="date" class="formulario__input" min="2021-01-01" max="2022-12-31" name="fechaPagoOportuno" id="fechaPagoOportuno" autocomplete="off">
      <i class="formulario__validacion-estado fas fa-times-circle"></i>
    </div>
    <p class="formulario__input-error"> no puede ir vacio</p>
  </div>
  <div class="error">
    <div class="form-text text-danger" th:if="${#fields.hasErrors('fechaPagoOportuno')}" th:errors="*{fechaPagoOportuno}"></div>
  </div>

  <!-- Grupo: Valor Préstamo-->
  <div class="formulario__grupo" id="grupo__valorPrestamo">
    <label for="nombre" class="formulario__label">Valor Préstamo</label>
    <div class="formulario__grupo-input">
      <input type="number" class="formulario__input" step="1" min="1000000" name="valorPrestamo" id="valorPrestamo" placeholder="Ejemplo: 1500000" autocomplete="off">
      <i class="formulario__validacion-estado fas fa-times-circle"></i>
    </div>
    <p class="formulario__input-error"> el valor max tiene que ser de 100000000 y solo puede contener numeros.</p>
  </div>
  <div class="error">
    <div class="form-text text-danger" th:if="${#fields.hasErrors('valorPrestamo')}" th:errors="*{valorPrestamo}"></div>
  </div>

    <!-- Grupo: tasa Préstamo-->
    <div class="formulario__grupo" id="grupo__tasaPrestamo">
      <label for="tasaPrestamo" class="formulario__label">Tasa Préstamo</label>
      <div class="formulario__grupo-input">
        <input type="number" class="formulario__input" minlength="1" maxlength="4" name="tasaPrestamo" id="tasaPrestamo"  placeholder="Ejemplo: 1.4" autocomplete="off">
        <i class="formulario__validacion-estado fas fa-times-circle"></i>
      </div>
      <p class="formulario__input-error"> tiene que ser de 1 a 15 dígitos y solo puede contener numeros y puntos(despues del punto debe ir otro numero)</p>
    </div>
    <div class="error">
      <div class="form-text text-danger" th:if="${#fields.hasErrors('tasaPrestamo')}" th:errors="*{tasaPrestamo}"></div>
    </div>
        <!-- Grupo: Periodo Cuotas-->
        <div class="formulario__grupo" id="grupo__periodoCuota">
          <label for="estado" class="formulario__label">Periodo de Cuotas</label>
                  <select  class="opciones" th:field="*{periodoCuota}" id="periodoCuota" minlength="7" maxlength="14">
                    <option value="">Selecciona una opción</option>
                    <option value="Mensual">Mensual</option>
                    <option value="Trimestral">Trimestral</option>
                    <option value="Cuatrimensual">Cuatrimensual</option>
                    <option value="Quinquemestral">Quinquemestral</option>
                    <option value="Semestral">Semestral</option>
                  </select>
                </div>
                <div class="error">
                  <div class="form-text text-danger" th:if="${#fields.hasErrors('periodoCuota')}" th:errors="*{periodoCuota}"></div>
                </div>
       <!-- Grupo:Número Cuotas-->
       <div class="formulario__grupo" id="grupo__numeroCuotas">
        <label for="numeroCuotas" class="formulario__label">Número Cuotas</label>
        <div class="formulario__grupo-input">
          <input type="number" class="formulario__input"  min="1" max="96" name="numeroCuotas" id="numeroCuotas" placeholder="Ejemplo: 12" autocomplete="off">
          <i class="formulario__validacion-estado fas fa-times-circle"></i>
        </div>
        <p class="formulario__input-error"> tiene que ser de 1 a 96  y solo puede contener numeros.</p>
      </div>
      <div class="error">
        <div class="form-text text-danger" th:if="${#fields.hasErrors('numeroCuotas')}" th:errors="*{numeroCuotas}"></div>
      </div>
    <!-- Grupo: Estado Préstamo-->
    <div class="formulario__grupo" id="grupo__estadoPrestamo">
      <label for="estadoPrestamo" class="formulario__label">Estado Préstamo</label>
              <select  class="opciones" th:field="*{estadoPrestamo}" id="estadoPrestamo">
                <option value="" selected>Selecciona una opción</option>
                        <option value="Inactivo">Inactivo</option>
                        <option value="Activo">Activo</option>
                        <option value="Congelado">Congelado</option>
              </select>
            </div>
            <div class="error">
              <div class="form-text text-danger" th:if="${#fields.hasErrors('estadoPrestamo')}" th:errors="*{estadoPrestamo}"></div>
              <div class="form-text text-danger" th:if="${errorMessage}" th:text="${errorMessage}"></div>       
             </div>
             <br>
             <div class="formulario__grupo formulario__grupo-btn-enviar">
              <button type="submit" class="formulario__btn">Enviar</button>
              <p class="formulario__mensaje-exito" id="formulario__mensaje-exito">Formulario enviado exitosamente!</p>
          </div>
        </form>      
            </div>
            <div class="modal-footer">
              
            </div>
          </div>
        </div>
    </div>

    <script>
      var datat=document.querySelector("#table-prestamo"); 
      var dataTable=new DataTable("#table-prestamo",{ 
        perPage:10,
        labels: {
            placeholder: "Buscar...",
            perPage: "{select} registros por página",
            noRows: "No se encontraron registros",
            info: "Mostrando {start} a {end} de {rows} préstamos (Página {page} de {pages} páginas)",
        }
      } ) ;
    </script>

    <script>
      var checkbox = document.getElementById('mostrar');
      var row = document.querySelectorAll('#tablerow');
      var estado = document.querySelectorAll('#estado');

      checkbox.addEventListener("click",mostrar)
      
      if (checkbox.checked==false) {
        for (let index = 0; index < estado.length; index++) {
          if (estado[index].textContent=="Inactivo") {
            for (let index = 0; index < row.length; index++) {
              if (estado[index].textContent=="Inactivo") {
                row[index].setAttribute('style','display:none');
              }
            }
          }
          console.log(estado[index].textContent)
        }
      }
      
      function mostrar(){
        if (checkbox.checked==true) {
          for (let index = 0; index < estado.length; index++) {
            if (estado[index].textContent=="Inactivo") {
              for (let index = 0; index < row.length; index++) {
                if (estado[index].textContent=="Inactivo") {
                  row[index].setAttribute('style','display:');
                }
              }
            }
          }
        }else if (checkbox.checked==false){
          for (let index = 0; index < estado.length; index++) {
            if (estado[index].textContent=="Inactivo") {
              for (let index = 0; index < row.length; index++) {
                if (estado[index].textContent=="Inactivo") {
                  row[index].setAttribute('style','display:none');
                }
              }
            }
          }
        }
      }
    </script>
        <script>
          $('#submitEdit').on('click',function(e){
              e.preventDefault();
              var form = $(this).parents('form');
              Swal.fire({
                  title: 'seguro quieres realizar esta accion?',
                  text: "ya no podras dar vuelta atras!",
                  type: 'warning',
                  showCancelButton: true,
                  confirmButtonColor: '#3085d6',
                  cancelButtonColor: '#d33',
                  confirmButtonText: 'si, editar!'
              }).then((result) => {
                  if (result.value) {
      
                      form.submit();
                  }
              });
          });
      </script>
       <script>
        $('#registrar').on('click',function(e){
            e.preventDefault();
            var form = $(this).parents('formulario');
            Swal.fire({
                title: 'quieres guardar este nuevo prestamo?',
                text: "quedara guardado y no se podra borrar!",
                type: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'si, guardar!'
            }).then((result) => {
                if (result.value) {
    
                    form.submit();
                }
            });
        });
    </script>
    <script>
      const formulario = document.getElementById('formulario');
   const inputs = document.querySelectorAll('#formulario input');
   
   const expresiones = {
     documentoPrestamista: /^[0-9]{8,10}$/, // Letras, numeros, guion y guion_bajo
     nombrePrestamista: /^[a-zA-ZÀ-ÿ\s]{5,50}$/, // Letras y espacios, pueden llevar acentos.
     fechaPagoOportuno: /^[0-9\_\-]{4,100}$/, // Letras y espacios, pueden llevar acentos.
     valorPrestamo:/^[0-9]{100,100000000}$/,
     tasaPrestamo:/^[0-9]+([.][0-9]+)?$/,
     numeroCuotas:/^[0-9]{1,50}$/,
   }
   
   const campos = {
    documentoPrestamista: false,
    nombrePrestamista:false,
    fechaPagoOportuno: false,
    valorPrestamo: false,
    tasaPrestamo: false,
    numeroCuotas: false,
    
   }
   
   const validarFormulario = (e) => {
     switch (e.target.name) {
       case " documentoPrestamista":
         validarCampo(expresiones. documentoPrestamista, e.target, 'documentoPrestamista');
       break;
       case "nombrePrestamista":
         validarCampo(expresiones.nombrePrestamista, e.target, 'nombrePrestamista');
       break;
       case "fechaPagoOportuno":
         validarCampo(expresiones.fechaPagoOportuno, e.target, 'fechaPagoOportuno');
       break;
       case "valorPrestamo":
         validarCampo(expresiones.valorPrestamo, e.target, 'valorPrestamo');
       break;
       case "tasaPrestamo":
         validarCampo(expresiones.tasaPrestamo, e.target, 'tasaPrestamo');
       break;
       case "numeroCuotas":
         validarCampo(expresiones.numeroCuotas, e.target, 'numeroCuotas');
       break;
       
     }
   }
   
   const validarCampo = (expresion, input, campo) => {
     if(expresion.test(input.value)){
       document.getElementById(`grupo__${campo}`).classList.remove('formulario__grupo-incorrecto');
       document.getElementById(`grupo__${campo}`).classList.add('formulario__grupo-correcto');
       document.querySelector(`#grupo__${campo} i`).classList.add('fa-check-circle');
       document.querySelector(`#grupo__${campo} i`).classList.remove('fa-times-circle');
       document.querySelector(`#grupo__${campo} .formulario__input-error`).classList.remove('formulario__input-error-activo');
       campos[campo] = true;
     } else {
       document.getElementById(`grupo__${campo}`).classList.add('formulario__grupo-incorrecto');
       document.getElementById(`grupo__${campo}`).classList.remove('formulario__grupo-correcto');
       document.querySelector(`#grupo__${campo} i`).classList.add('fa-times-circle');
       document.querySelector(`#grupo__${campo} i`).classList.remove('fa-check-circle');
       document.querySelector(`#grupo__${campo} .formulario__input-error`).classList.add('formulario__input-error-activo');
       campos[campo] = false;
     }
   }
   
   inputs.forEach((input) => {
     input.addEventListener('keyup', validarFormulario);
     input.addEventListener('blur', validarFormulario);
   });
   
   
   
       </script>
       <script>
        const valor=document.getElementById("valorPrestamo");
        const total=document.getElementById("totalPago");
       

        function cambiarMax() {
          let valor1=parseInt(valor.options[valor.selectedIndex].textContent)
          total.setAttribute("max",valor1)
        }
        valor.addEventListener("click", cambiarMax)
       </script>
       <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</body>
</html>